<!--Author: W3layouts
Author URL: http://w3layouts.com
License: Creative Commons Attribution 3.0 Unported
License URL: http://creativecommons.org/licenses/by/3.0/
-->
<!DOCTYPE HTML>
<html>
<head>
<title>Change Medicine Inventory</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="keywords" content="Shoppy Responsive web template, Bootstrap Web Templates, Flat Web Templates, Android Compatible web template,
Smartphone Compatible web template, free webdesigns for Nokia, Samsung, LG, SonyEricsson, Motorola web design" />
    <style>
        .searchbox
        {
            background: white;
            color: black;
            font-family: "Ubuntu Light";
            font-size: 150%;
            border-radius: 5%;
            border-width: 3px;
            border-color: black;
        }

        .submitButton
        {
            position:fixed;
            top: 90%;
            left: 45%;
            width: 10%;
            height: 6%;
            background: white;
            border: solid black;
            border-width: 1.5px;
            border-radius: 2px;
            font-family: "Ubuntu Light";
            color: black;
            font-size: 100%;
        }

        .submitButton:hover
        {
            position:fixed;
            top: 90%;
            left: 45%;
            width: 10%;
            height: 6%;
            background: black;
            border: solid white;
            border-width: 1.5px;
            border-radius: 2px;
            font-family: "Ubuntu Light";
            color: white;
            font-size: 100%;
        }
    </style>
<script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } </script>
<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<link href="static/css/bootstrap.css" rel="stylesheet" type="text/css" media="all">
<!-- Custom Theme files -->
<link href="static/css/style.css" rel="stylesheet" type="text/css" media="all"/>
<!--js-->
<script src="static/js/jquery-2.1.1.min.js"></script>
<!--icons-css-->
<link href="static/css/font-awesome.css" rel="stylesheet">
<!--Google Fonts-->
<link href='//fonts.googleapis.com/css?family=Carrois+Gothic' rel='stylesheet' type='text/css'>
<link href='//fonts.googleapis.com/css?family=Work+Sans:400,500,600' rel='stylesheet' type='text/css'>
<!--static chart-->
<script src="static/js/Chart.min.js"></script>
<!--//charts-->
<!-- geo chart -->
    <script src="//cdn.jsdelivr.net/modernizr/2.8.3/modernizr.min.js" type="text/javascript"></script>
   <!-- <script>window.modernizr || document.write('<script src="lib/modernizr/modernizr-custom.js"><\/script>')</script>
    <!--<script src="lib/html5shiv/html5shiv.js"></script>-->
     <!-- Chartinator  -->
    <script src="static/js/chartinator.js" ></script>
    <script type="text/javascript">
        jQuery(function ($) {

            var chart3 = $('#geoChart').chartinator({
                tableSel: '.geoChart',

                columns: [{role: 'tooltip', type: 'string'}],

                colIndexes: [2],

                rows: [
                    ['China - 2015'],
                    ['Colombia - 2015'],
                    ['France - 2015'],
                    ['Italy - 2015'],
                    ['Japan - 2015'],
                    ['Kazakhstan - 2015'],
                    ['Mexico - 2015'],
                    ['Poland - 2015'],
                    ['Russia - 2015'],
                    ['Spain - 2015'],
                    ['Tanzania - 2015'],
                    ['Turkey - 2015']],

                ignoreCol: [2],

                chartType: 'GeoChart',

                chartAspectRatio: 1.5,

                chartZoom: 1.75,

                chartOffset: [-12,0],

                chartOptions: {

                    width: null,

                    backgroundColor: '#fff',

                    datalessRegionColor: '#F5F5F5',

                    region: 'world',

                    resolution: 'countries',

                    legend: 'none',

                    colorAxis: {

                        colors: ['#679CCA', '#337AB7']
                    },
                    tooltip: {

                        trigger: 'focus',

                        isHtml: true
                    }
                }


            });
        });
    </script>
<!--geo chart-->

<!--skycons-icons-->
<script src="static/js/skycons.js"></script>
<!--//skycons-icons-->
</head>
<body onload="loadData()">
<div class="page-container">
   <div class="left-content">
	   <div class="mother-grid-inner">
            <!--header start here-->
				<div class="header-main">
					<div class="header-left">
							<div class="logo-name">
									 <a href="index.html"> <h1>Pharmassistant</h1>
									<!--<img id="logo" src="" alt="Logo"/>-->
								  </a>
							</div>
							<!--search-box-->
								<!--//end-search-box-->
							<div class="clearfix"> </div>
						 </div>
						 <div class="header-right">
							<div class="profile_details_left" style="position: fixed; right: 4.5%"><!--notifications of menu start -->
                                <a href="/signout" style="position: fixed; top: 4.7%; right: 1%; font-family: 'Ubuntu Light'; font-size: 110%; color: black">Sign Out</a>
								<ul class="nofitications-dropdown" style="margin-left: 80%">
									<li class="dropdown head-dpdn">
										<a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false"><i class="fa fa-bell"></i><span class="badge blue">3</span></a>
										<ul class="dropdown-menu">
											<li>
												<div class="notification_header">
													<h3>You have 3 new notification</h3>
												</div>
											</li>
											<li><a href="#">
												<div class="user_img"><img src="static/images/p5.png" alt=""></div>
											   <div class="notification_desc">
												<p>Lorem ipsum dolor</p>
												<p><span>1 hour ago</span></p>
												</div>
											  <div class="clearfix"></div>
											 </a></li>
											 <li class="odd"><a href="#">
												<div class="user_img"><img src="static/images/p6.png" alt=""></div>
											   <div class="notification_desc">
												<p>Lorem ipsum dolor</p>
												<p><span>1 hour ago</span></p>
												</div>
											   <div class="clearfix"></div>
											 </a></li>
											 <li><a href="#">
												<div class="user_img"><img src="static/images/p7.png" alt=""></div>
											   <div class="notification_desc">
												<p>Lorem ipsum dolor</p>
												<p><span>1 hour ago</span></p>
												</div>
											   <div class="clearfix"></div>
											 </a></li>
											 <li>
												<div class="notification_bottom">
													<a href="notifications">See all notifications</a>
												</div>
											</li>
										</ul>
									</li>

								</ul>
								<div class="clearfix"> </div>
							</div>
							<!--notification menu end -->
							<div class="profile_details">
								<ul>
									<li class="dropdown profile_details_drop">
										<a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">

										</a>
										<ul class="dropdown-menu drp-mnu">
											<li> <a href="#"><i class="fa fa-cog"></i> Settings</a> </li>
											<li> <a href="#"><i class="fa fa-user"></i> Profile</a> </li>
											<li> <a href="#"><i class="fa fa-sign-out"></i> Logout</a> </li>
										</ul>
									</li>
								</ul>
							</div>
							<div class="clearfix"> </div>
						</div>
				     <div class="clearfix"> </div>
				</div>
<!--heder end here-->
<!-- script-for sticky-nav -->
		<script>
		$(document).ready(function() {
			 var navoffeset=$(".header-main").offset().top;
			 $(window).scroll(function(){
				var scrollpos=$(window).scrollTop();
				if(scrollpos >=navoffeset){
					$(".header-main").addClass("fixed");
				}else{
					$(".header-main").removeClass("fixed");
				}
			 });

		});
		</script>
		<!-- /script-for sticky-nav -->

 <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script type="text/javascript">
function showOptions(opNum)
        {
            if(opNum==1)
            {
                document.getElementById("add").style="position: fixed; top: 10%; left: 17%; font-size: 100%; font-family: Ubuntu;";
                document.getElementById("remove").style="position: fixed; top: 10%; left: 17%; font-size: 100%; font-family: Ubuntu; visibility: hidden";
                document.getElementById("change").style="position: fixed; top: 10%; left: 17%; font-size: 100%; font-family: Ubuntu; visibility: hidden";
                op="add";
            }
            else if(opNum==2)
            {
                document.getElementById("add").style="position: fixed; top: 10%; left: 17%; font-size: 100%; font-family: Ubuntu; visibility: hidden";
                document.getElementById("remove").style="position: fixed; top: 10%; left: 17%; font-size: 100%; font-family: Ubuntu;";
                document.getElementById("change").style="position: fixed; top: 10%; left: 17%; font-size: 100%; font-family: Ubuntu; visibility: hidden";
                op="remove";
            }
            else if(opNum==3)
            {
                document.getElementById("add").style="position: fixed; top: 10%; left: 17%; font-size: 100%; font-family: Ubuntu; visibility: hidden";
                document.getElementById("remove").style="position: fixed; top: 10%; left: 17%; font-size: 100%; font-family: Ubuntu; visibility: hidden";
                document.getElementById("change").style="position: fixed; top: 10%; left: 17%; font-size: 100%; font-family: Ubuntu;";
                op="change";
            }
            document.getElementById("submit").style="visibility: visible";
        }

        var op="";
        var toSend="";

        medList = {{ medList|tojson }}


        window.onload = function WindowLoad(event)
        {
            for(var i=0;i<medList.length;i++)
            {
                tempArr = medList[i].split("#");

                var remOpt = document.getElementById("removeSelection");
                var chngOpt = document.getElementById("changeMed");
                var addCmp = document.getElementById("addCompany");
                var addTyp = document.getElementById("addType");

                remOpt.options[remOpt.options.length] = new Option(tempArr[0], tempArr[0].toLowerCase());
                chngOpt.options[chngOpt.options.length] = new Option(tempArr[0], tempArr[0].toLowerCase());
                addCmp.options[addCmp.options.length] = new Option(tempArr[3], tempArr[3].toLowerCase());
                addTyp.options[addTyp.options.length] = new Option(tempArr[2], tempArr[2].toLowerCase());
            }
        };


        function submitChangeButton()
        {
            if(op=="add")
            {

                var id = document.getElementById("addID").value;
                var name = document.getElementById("addName").value;
                var type = document.getElementById("addType").value;
                var company = document.getElementById("addCompany").value;
                var price = document.getElementById("addPrice").value;
                var quantity = document.getElementById("addQuantity").value;
                var expiry_date = document.getElementById("addDate").value;
                var shelf = document.getElementById("addShelf").value;


                if(id=="")
                {
                    alert("Please enter medicine ID");
                    return;
                }

                if(name=="")
                {
                    alert("Please enter medicine name");
                    return;
                }

                if(type=="")
                {
                    alert("Please enter medicine type");
                    return;
                }

                if(company=="")
                {
                    alert("Please enter medicine company");
                    return;
                }

                if(price=="")
                {
                    alert("Please enter medicine price");
                    return;
                }

                if(quantity=="")
                {
                    alert("Please enter medicine quantity");
                    return;
                }

                if(expiry_date=="")
                {
                    alert("Please enter medicine expiry date");
                    return;
                }

                if(shelf=="")
                {
                    alert("Please enter medicine shelf number");
                    return;
                }


                for(var i=0;i<medList.length;i++)
                {
                    tempMed = medList[i].split("#");
                    if(tempMed[0]==id)
                    {
                        alert("ID already in use.");
                        return;
                    }
                }
                toSend=op+"#"+id+"#"+name+"#"+type+"#"+company+"#"+price+"#"+quantity+"#"+expiry_date+"#"+shelf;
                //alert(toSend);
                uploadFile();
                submitChange();

            }
            else if(op=="remove")
            {

                var medN = document.getElementById("removeSelection").value;
                if(medN=="")
                {
                    alert("Please select a medicine ID");
                    return;
                }
                toSend=op+"#"+medN;
                submitChange();

            }
            else if(op=="change")
            {

                var medN2 = document.getElementById("changeMed").value;
                var attrbute = document.getElementById("changeAttribute").value;
                var newValue = document.getElementById("newValue").value;
                medN2 = medN2.toString();
                attribute = attrbute.toString();
                newValue = newValue.toString();
                if(medN2=="")
                {
                    alert("Please select a medicine ID");
                    return;
                }
                if(attribute=="")
                {
                    alert("Please select an attribute");
                    return;
                }
                if(newValue=="")
                {
                    alert("Please enter value.");
                    return;
                }

                if(attribute=="id")
                {
                    for(var i=0;i<medList.length;i++)
                    {
                        tempMed = medList[i].split("#");
                        if(tempMed[0]==newValue)
                        {
                            alert("ID already in use.");
                            return;
                        }
                    }
                }
                else if((attribute=="quantity" || attribute=="price") && isNaN(newValue))
                {
                    alert("Please insert a valid number");
                    return;
                }
                else if(attrbute=="quantity" && newValue!=parseInt(newValue))
                {
                    alert("Quantity must not be fractional.")
                    return;
                }
                else if(attribute=="date")
                {
                    var tempAtt = newValue.split("-");
                    var tempVal = [];
                    tempVal[2]=Number(tempAtt[0])
                    tempVal[1]=Number(tempAtt[1])
                    tempVal[0]=Number(tempAtt[2])
                    if(tempVal[2]<2018)
                    {
                        alert("Please insert a valid date.");
                        return;
                    }
                    if(tempVal[1]<1 || tempVal[1]>12)
                    {
                        alert("Please insert a valid date.");
                        return;
                    }
                    if((tempVal[1]==9 || tempVal[1]==4 || tempVal==[1]==6 || tempVal[1]==11) && (tempVal[0]>30 || tempVal[0]<1))
                    {
                        alert("Please insert a valid date.");
                        return;
                    }
                    if((tempVal[1]==1 || tempVal[1]==3 || tempVal==[1]==5 || tempVal[1]==7 ||
                        tempVal[1]==8 || tempVal[1]==10 || tempVal[1]==12) && (tempVal[0]>31 || tempVal[0]<1))
                    {
                        alert("Please insert a valid date.");
                        return;
                    }
                    if(tempVal[1]==2)
                    {
                        if(tempVal[0]<1 || tempVal[0]>29)
                        {
                            alert("Please insert a valid date.");
                            return;
                        }
                        if(tempVal[0]==29)
                        {
                            if(!(tempVal[2]%400==0 || (tempVal[2]%4==0 && tempVal[2]%100!=0)))
                            {
                                alert("Please insert a valid date.");
                                return;
                            }
                        }
                    }
                }
                toSend=op+"#"+medN2+"#"+attrbute+"#"+newValue;
                submitChange();
            }

        }

        function uploadFile()
        {
            var formData = new FormData();
            var target = "/imageUpload";
            formData.append("file", document.getElementById("file").files[0]);
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function()
            {
                //alert(xhr.responseText);
            };
            xhr.open("POST", target, true);
            xhr.send(formData);
            xhr.onload = function()
            {
                if(this.status!=200)console.log(this.status+"\n"+this.statusText);
            };
        }


        function submitChange()
        {
            msg = [{"change": ""+toSend}];
            var temp = JSON.stringify(msg);
            $.post("/medChange", temp, function(){});
            location.assign('/medicines');
        }



    </script>

<!--inner block start here-->
<div class="inner-block" style="height: 700px;">
	<!-- <% emne eitar vitor python code lkha jay %> -->
    <div>



        <!-- NEW HTML PAGE CODE GOES HERE -->


        <!-- COPY PASTE YOUR HTML BODY CODE HERE -->


        <!-- NEW HTML PAGE CODE ENDS HERE -->


    </div>

</div>
<!--inner block end here-->

</div>
</div>
<!--slider menu-->
    <div class="sidebar-menu">
		  	<div class="logo"> <a href="#" class="sidebar-icon"> <span class="fa fa-bars"></span> </a> <a href="#"> <span id="logo" ></span>
			      <!--<img id="logo" src="" alt="Logo"/>-->
			  </a> </div>
		    <div class="menu">
		      <ul id="menu" >
		       <li id="menu-home" ><a href="/home"><i class="fa fa-home"></i><span>Home</span></a></li>
		         <li><a href="/notifications"><i class="fa fa-bell-o"></i><span>Notifications</span></a></li>

                  <li id="menu-comunicacao" ><a href="/medicines"><i class="fa fa-medkit"></i><span>Medicines</span><span class="fa fa-angle-right" style="float: right;"></span></a>
		          <ul id="menu-comunicacao-sub" >
		            <li id="menu-mensagens" style="width: 120px" ><a href="/medicines">Medicine List</a>
		            </li>
		            <li id="menu-arquivos" ><a href='/medicineListModify'>Add Medicine</a></li>
		          </ul>
		        </li>
                <li><a href="/companies"><i class="fa fa-ambulance"></i><span>Medicine Companies</span><span class="fa fa-angle-right" style="float: right"></span></a>
		          <ul>
		            <li><a href="/companies">Company List</a></li>
		            <li><a href="/addCompany">Register Company</a></li>
		          </ul>
		        </li>

                  <li><a href="/orders"><i class="fa fa-suitcase"></i><span>Orders</span><span class="fa fa-angle-right" style="float: right"></span></a>
		          <ul>
		            <li><a href="/orders">Order List</a></li>
		            <li><a href="/orders/placeOrder">Place Order</a></li>
		          </ul>
		        </li>
		          <li><a href="/makeReceipt"><i class="fa fa-calculator"></i><span>Make Receipt</span></a></li>

		        </li>

		        <li><a href="/finances"><i class="fa fa-dollar"></i><span>Finances</span></a></li>
		        <li><a href="/accounts"><i class="fa fa-list-alt"></i><span>Manage Accounts</span></a></li>
                  <li><a href="/aboutUs"><i class="fa fa-support"></i><span>About Us</span></a>

		        </li>

		      </ul>
		    </div>
	 </div>
	<div class="clearfix"> </div>
</div>
<!--slide bar menu end here-->



<script>
var toggle = true;

$(".sidebar-icon").click(function() {
  if (toggle)
  {
    $(".page-container").addClass("sidebar-collapsed").removeClass("sidebar-collapsed-back");
    $("#menu span").css({"position":"absolute"});
  }
  else
  {
    $(".page-container").removeClass("sidebar-collapsed").addClass("sidebar-collapsed-back");
    setTimeout(function() {
      $("#menu span").css({"position":"relative"});
    }, 400);
  }
                toggle = !toggle;
            });
</script>
<!--scrolling js-->
		<script src="static/js/jquery.nicescroll.js"></script>
		<script src="static/js/scripts.js"></script>
		<!--//scrolling js-->
<script src="static/js/bootstrap.js"> </script>
<!-- mother grid end here-->

    <select name="Operation" onchange="showOptions(this.selectedIndex)" style="position: fixed; top: 18%; left: 18%; font-family: Ubuntu; font-size: 100%; background-color: white;
                                    border: 2px solid black; border-radius: 1px; color: black;">
        <option value="" disabled selected>Select Operation</option>
        <option value="add">Add Medicine</option>
        <option value="remove">Remove Medicine</option>
        <option value="change">Change Medicine Data</option>
    </select>

    <div id="add" style="position: fixed; top: 20%; left: 18%; font-size: 100%; font-family: Ubuntu; visibility: hidden;">
        <input type="number" id="addID" min="1" placeholder="Medicine ID" style="position: fixed; top: 25%; left: 18%; background-color: white;
                            border: 2px solid black; border-radius: 1px; color: black; width: 17%; font-size: 150%; font-family: Ubuntu">
        <input type="text" id="addName" placeholder="Medicine Name" style="position: fixed; top: 32%; left: 18%; background-color: white;
                            border: 2px solid black; border-radius: 1px; color: black; width: 17%; font-size: 150%; font-family: Ubuntu">
        <select id="addType" style="position: fixed; top: 39%; left: 18%; background-color: white; height: 7%;
                            border: 2px solid black; border-radius: 1px; color: black; width: 17%; font-size: 150%; font-family: Ubuntu">
            <option value="" disabled selected>Select Type</option>
        </select>
        <select id="addCompany" placeholder="Medicine Company" style="position: fixed; top: 46%; left: 18%; background-color: white; height: 7%;
                            border: 2px solid black; border-radius: 1px; color: black; width: 17%; font-size: 150%; font-family: Ubuntu">
            <option value="" disabled selected>Select Company</option>
        </select>
        <input type="number" id="addPrice" placeholder="Medicine Price/Unit" min="1" style="position: fixed; top: 53%; left: 18%; background-color: white;
                            border: 2px solid black; border-radius: 1px; color: black; width: 17%; font-size: 150%; font-family: Ubuntu">
        <input type="number" id="addQuantity" placeholder="Medicine Quantity" min="1" style="position: fixed; top: 60%; left: 18%; background-color: white;
                            border: 2px solid black; border-radius: 1px; color: black; width: 17%; font-size: 150%; font-family: Ubuntu">
        <input id="addDate" placeholder="Expiry Date" class = "textbox-n" type = "text" onfocus = "(this.type = 'date')" onblur="(this.type='text')"
               style="position: fixed; top: 67%; left: 18%; background-color: white;
                            border: 2px solid black; border-radius: 1px; color: black; width: 17%; font-size: 150%; font-family: Ubuntu">
        <input type="text" id="addShelf" placeholder="Shelf Location" style="position: fixed; top: 74%; left: 18%; background-color: white;
                            border: 2px solid black; border-radius: 1px; color: black; width: 17%; font-size: 150%; font-family: Ubuntu">
        <input id="file" type=file name=file style="position:fixed; top: 81%; left: 18%;">
    </div>

    <div id="remove" style="position: fixed; top: 20%; left: 18%; font-size: 100%; font-family: Ubuntu; visibility: hidden">
        <select id="removeSelection" name="RemoveMedicine" style="position: fixed; top: 24%; left: 18%; background-color: white;
                            border: 2px solid black; border-radius: 1px; color: black; width: 17%; font-size: 150%; font-family: Ubuntu">
            <option value="" disabled selected>Select Medicine ID</option>
        </select>
    </div>

    <div id="change" style="position: fixed; top: 20%; left: 18%; font-size: 100%; font-family: Ubuntu; visibility: hidden">
        <select id="changeMed" name="RemoveMedicine" style="position: fixed; top: 24%; left: 18%; background-color: white;
                            border: 2px solid black; border-radius: 1px; color: black; width: 17%; font-size: 150%; font-family: Ubuntu">
            <option value="" disabled selected>Select Medicine</option>
        </select>

        <select id="changeAttribute" name="ChooseAttribute" style="position: fixed; top: 32%; left: 18%; background-color: white;
                            border: 2px solid black; border-radius: 1px; color: black; width: 17%; font-size: 150%; font-family: Ubuntu">
            <option value="" disabled selected>Select Attribute</option>
            <option value="id">ID</option>
            <option value="name">Name</option>
            <option value="type">Type</option>
            <option value="company">Company</option>
            <option value="price">Price</option>
            <option value="quantity">Quantity</option>
            <option value="date">Date</option>
            <option value="shelf">Shelf</option>
            <option value="image">Image Path</option>
        </select>

        <input type="text" id="newValue" style="position: fixed; top: 40%; left: 18%; background-color: white;
                            border: 2px solid black; border-radius: 1px; color: black; width: 16.7%; font-size: 150%; font-family: Ubuntu" placeholder="New Value">
        <p id="Hint" style="position: fixed; top: 48%; left: 18%;
                            color: gray;font-size: 130%; font-family: Ubuntu">Date should be in YYYY-MM-DD format.</p>
    </div>

    <button class="submitButton" id="submit" style="visibility: hidden" onclick="submitChangeButton()">
        Submit
    </button>

</body>
</html>