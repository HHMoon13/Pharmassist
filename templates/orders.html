
<!DOCTYPE HTML>
<html>
<head>
<title>Pharmassistant</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="keywords" content="Shoppy Responsive web template, Bootstrap Web Templates, Flat Web Templates, Android Compatible web template,
Smartphone Compatible web template, free webdesigns for Nokia, Samsung, LG, SonyEricsson, Motorola web design" />
    <style>
        .searchbox
        {
            background: white;
            color: black;
            font-family: "Ubuntu Light";
            font-size: 150%;
            border-radius: 5%;
            border-width: 3px;
            border-color: black;
        }

        .submitButton
        {
            position:fixed;
            top: 54%;
            left: 44%;
            width: 10%;
            height: 5%;
            background: white;
            border: solid black;
            border-width: 1.5px;
            border-radius: 5px;
            font-family: "Ubuntu Light";
            color: black;
            font-size: 100%;
        }

        .submitButton:hover
        {
            position:fixed;
            top: 54%;
            left: 44%;
            width: 10%;
            height: 5%;
            background: black;
            border: solid white;
            border-width: 1.5px;
            border-radius: 5px;
            font-family: "Ubuntu Light";
            color: white;
            font-size: 100%;
        }

    </style>
<script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } </script>
<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<link href="static/css/bootstrap.css" rel="stylesheet" type="text/css" media="all">
<!-- Custom Theme files -->
<link href="static/css/style.css" rel="stylesheet" type="text/css" media="all"/>
<!--js-->
<script src="static/js/jquery-2.1.1.min.js"></script>
<!--icons-css-->
<link href="static/css/font-awesome.css" rel="stylesheet">
<!--Google Fonts-->
<link href='//fonts.googleapis.com/css?family=Carrois+Gothic' rel='stylesheet' type='text/css'>
<link href='//fonts.googleapis.com/css?family=Work+Sans:400,500,600' rel='stylesheet' type='text/css'>
<!--static chart-->
<script src="static/js/Chart.min.js"></script>
<!--//charts-->
<!-- geo chart -->
    <script src="//cdn.jsdelivr.net/modernizr/2.8.3/modernizr.min.js" type="text/javascript"></script>
   <!-- <script>window.modernizr || document.write('<script src="lib/modernizr/modernizr-custom.js"><\/script>')</script>
    <!--<script src="lib/html5shiv/html5shiv.js"></script>-->
     <!-- Chartinator  -->
    <script src="static/js/chartinator.js" ></script>

<!--geo chart-->

<!--skycons-icons-->
<script src="static/js/skycons.js"></script>
<!--//skycons-icons-->
</head>
<body onload="loadData()">
<div class="page-container">
   <div class="left-content">
	   <div class="mother-grid-inner">
            <!--header start here-->
				<div class="header-main">
					<div class="header-left">
							<div class="logo-name">
									 <a href=""> <h1>Pharmassistant</h1>
									<!--<img id="logo" src="" alt="Logo"/>-->
								  </a>
							</div>
							<!--search-box-->
								<!--//end-search-box-->
							<div class="clearfix"> </div>
						 </div>
						 <div class="header-right">
							<div class="profile_details_left" style="position: fixed; right: 4.5%"><!--notifications of menu start -->
                                <a href="/signout" style="position: fixed; top: 4.7%; right: 1%; font-family: 'Ubuntu Light'; font-size: 110%; color: black">Sign Out</a>
								<ul class="nofitications-dropdown" style="margin-left: 80%">
									<li class="dropdown head-dpdn">
										<a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false"><i class="fa fa-bell"></i><span class="badge blue">3</span></a>
										<ul class="dropdown-menu">
											<li>
												<div class="notification_header">
													<h3>You have 3 new notification</h3>
												</div>
											</li>
											<li><a href="#">
												<div class="user_img"><img src="static/images/p5.png" alt=""></div>
											   <div class="notification_desc">
												</div>
											   <div class="clearfix"></div>
											 </a></li>
											 <li><a href="#">
												<div class="user_img"><img src="static/images/p7.png" alt=""></div>
											   <div class="notification_desc">
												<p>Lorem ipsum dolor</p>
												<p><span>1 hour ago</span></p>
												</div>
											   <div class="clearfix"></div>
											 </a></li>
											 <li>
												<div class="notification_bottom">
													<a href="notifications">See all notifications</a>
												</div>
											</li>
										</ul>
									</li>

								</ul>
								<div class="clearfix"> </div>
							</div>
							<!--notification menu end -->
							<div class="profile_details">
								<ul>
									<li class="dropdown profile_details_drop">
										<a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
										</a>
										<ul class="dropdown-menu drp-mnu">
											<li> <a href="\accounts"><i class="fa fa-cog"></i>Accounts</a> </li>
										</ul>
									</li>
								</ul>
							</div>
							<div class="clearfix"> </div>
						</div>
				     <div class="clearfix"> </div>
				</div>
<!--heder end here-->
<!-- script-for sticky-nav -->
		<script>
		$(document).ready(function() {
			 var navoffeset=$(".header-main").offset().top;
			 $(window).scroll(function(){
				var scrollpos=$(window).scrollTop();
				if(scrollpos >=navoffeset){
					$(".header-main").addClass("fixed");
				}else{
					$(".header-main").removeClass("fixed");
				}
			 });

		});
		</script>
		<!-- /script-for sticky-nav -->

 <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script type="text/javascript">



        orderlist = {{ orderlist|tojson}};
        medOrderList = {{ medOrderList|tojson}};
        console.log(medOrderList);
        console.log(orderlist);
        function createCell(cell, text, style) {
            var div = document.createElement('div'), // create DIV element
                txt = document.createTextNode(text); // create text node
            div.appendChild(txt);                    // append text node to the DIV
           // div.setAttribute('class', style);        // set DIV class attribute
            //div.setAttribute('className', style);    // set DIV class attribute for IE (?!)
            cell.appendChild(div);                   // append DIV to the table cell
        }

        function restrictMinus(e) {
                var inputKeyCode = e.keyCode ? e.keyCode : e.which;

                if (inputKeyCode != null) {
                    if (inputKeyCode < 48 && inputKeyCode != 46) e.preventDefault();
                    if (inputKeyCode > 57) e.preventDefault();
                }
        }


        function loadData() {
            orders = orderlist;

             for (var i = 0; i < orders.length; i++) {
                 order = JSON.parse(orders[i]);
                 var tbl = document.getElementById('ordertbl'), // table reference
                 row = tbl.insertRow(tbl.rows.length),      // append table row
                 i;
                // insert table cells to the new row

                 createCell(row.insertCell(0), order.orderID, 'row');
                 createCell(row.insertCell(1), order.companyName, 'row');
                 createCell(row.insertCell(2), order.totalCost, 'row');
                 createCell(row.insertCell(3), order.due, 'row');
                 createCell(row.insertCell(4), order.orderDate, 'row');
                 createCell(row.insertCell(5), order.dueDate, 'row');
                 createCell(row.insertCell(6), order.status, 'row');
 // <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal" data-whatever="@getbootstrap">Open modal for @getbootstrap</button>

                 newCell = row.insertCell(7);
                 newElem = document.createElement( 'input' );
                 newElem.setAttribute("type", "button");
                 newElem.setAttribute("value", "Details");
                 newElem.setAttribute("class", "btn btn-primary");
                 //newElem.setAttribute("onclick", "showModal(this)");
                 newElem.setAttribute("data-toggle", "modal");
                 newElem.setAttribute("data-target", "#exampleModal");
                 newElem.setAttribute("data-whatever", i);



                 newCell.appendChild(newElem);

             }
        }


        $(document).on('show.bs.modal','#exampleModal', function (event) {
             var button = $(event.relatedTarget); // Button that triggered the modal
              var id = button.data('whatever'); // Extract info from data-* attributes
              // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
              // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
              var modal = $(this);
            //var tbl = modal.find('.orderDetails');
            document.getElementById("save").style.display = "none";
            document.getElementById("update").style.display = "block";
            document.getElementById("paid").setAttribute("disabled", false);
            document.getElementById("status").setAttribute("disabled", false);
            order = JSON.parse(orderlist[id]);
            orderid = order.orderID;
            var tbl = document.getElementById('orderDetails');
            for(var i = tbl.rows.length - 1; i > 0; i--)
            {
                tbl.deleteRow(i);
            }
            for (var i = 0; i < medOrderList.length; i++) {
                mediorder = JSON.parse(medOrderList[i]);
                var x = 1;
                if(mediorder.order_id==orderid){
                    var tbl = document.getElementById('orderDetails'),
                    row = tbl.insertRow(x);     // append table row

                    x++;
                    createCell(row.insertCell(0), mediorder.medName, 'row');
                    createCell(row.insertCell(1), mediorder.qty, 'row');
                    createCell(row.insertCell(2), mediorder.cost, 'row');

                }
            }
            document.getElementById("orderID").value = orderid;
            document.getElementById("companyName").value = order.companyName;
            document.getElementById("totalCost").value = order.totalCost;
            document.getElementById("paid").value = order.paid;
            document.getElementById("due").value = order.due;
            document.getElementById("dueValue").value = order.due;

            document.getElementById("status").value = order.status;

            document.getElementById("hidden").value = id;
            modal.find('.modal-title').text('Order details of order ' + orderid);
             // modal.find('.modal-body input').val(id);
        })


        function updateOrder() {


            due = document.getElementById("due").value;
            status = document.getElementById("status").value;
            if(due > 0)
            {
                document.getElementById("paid").removeAttribute("disabled");
                document.getElementById("save").style.display = "block";
                document.getElementById("update").style.display = "none";
            }
            if(status == "false"){
                document.getElementById("save").style.display = "block";
                document.getElementById("update").style.display = "none";
                document.getElementById("status").removeAttribute("disabled");
            }

        }

        function saveOreder() {
            var id  = document.getElementById("hidden").value;
            total = document.getElementById("dueValue").value;
            paid = document.getElementById("paid").value;
            status = document.getElementById("status").value;


            due = Number(total) - Number(paid);
            if(due < 0)
                due = 0;
            order = JSON.parse(orderlist[id]);

            order.paid = paid;
            order.due = due;
            order.status = status;
            document.getElementById("save").style.display = "none";
            document.getElementById("update").style.display = "block";

            //var temp = JSON.stringify(order);
            $.post("/updateOrder", order, function () {

                });

            location.reload();

        }

        function paidAmount() {
            p = document.getElementById("paid").value;
            total = document.getElementById("dueValue").value;
            var due = Number(total) - Number(p);

            if(due<=0)
            {
                due = Number(p) - total;
                document.getElementById("due").value = String("0.00");

            }
            else {

                document.getElementById("due").value = due;
            }
        }

    </script>




<!--inner block start here-->
<div class="inner-block" style="height: 700px;">
	<!-- <% emne eitar vitor python code lkha jay %> -->
        <div>


    <div  class="col-sm-12">

        <div align="left"class="page-header">
        <h1 > Order Lists</h1>
    </div>
        <form align="right" action="/orders/placeOrder">

        <button type="submit" id="createOrderBtn" data-loading-text="Loading..." class="btn btn-primary"> Make New order</button>
        </form>
    </div>



    <table id="ordertbl" class="table table-hover table-bordered ">
          <thead class="thead-dark">
            <tr>

                <th scope="col">Order ID</th>
                <th scope="col">Company Name</th>
                <th scope="col">Total Cost</th>
                <th scope="col">Due Amount</th>
                <th scope="col">Order Date</th>
                <th scope="col">Due Date</th>
                <th scope="col">Status</th>
                <th scope="col">Action</th>
            </tr>
          </thead>
          <tbody>

          </tbody>
        </table>
</div>

<div class="modal fade" action="/updateOrder" method="post" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">New message</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">

            <div class="form-group">
            <label for="orderID" class="col-form-label">Order ID:</label>
            <input type="text" class="form-control" id="orderID" disabled>
          </div>
          <div class="form-group">
            <label for="companyName" class="col-form-label">Company Name:</label>
            <input class="form-control" id="companyName" disabled>
          </div>

          <table id="orderDetails" class="table table-hover table-bordered ">
          <thead class="thead-dark">
            <tr>
                <th scope="col">Medicine Name</th>
                <th scope="col">Quantity</th>
                <th scope="col">Cost</th>

            </tr>
          </thead>
          <tbody>

          </tbody>
        </table>
        <form>
          <div class="form-group">
            <label for="totalCost" class="col-form-label">Total Cost:</label>
            <input type="text" class="form-control" id="totalCost" disabled>
          </div>
          <div class="form-group">
            <label for="paid" class="col-form-label">Paid Amount:</label>
            <input type="text" onkeypress="restrictMinus(event);" class="form-control" id="paid" disabled  autocomplete="off" onkeyup="paidAmount()">
          </div>
            <div class="form-group">
            <label for="due" class="col-form-label">Due Amount:</label>
            <input class="form-control" id="due" disabled>
          </div>
           <div class="form-group">
            <label for="status" class="col-form-label">Status:</label>
            <input class="form-control" id="status" disabled>
          </div>
          <div class="form-group">
            <input class="form-control" id="hidden" disabled style="display:none;">
            <input class="form-control" id="dueValue" disabled style="display:none;">
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button onclick="updateOrder()" id="update" type="button" class="btn btn-primary" style="display:block;">Update</button>
        <button data-dismiss="modal" onclick="saveOreder()" id="save" type="button" class="btn btn-primary" style="display:none;">Save</button>

        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

</div>
<!--inner block end here-->

</div>
</div>
<!--slider menu-->
    <div class="sidebar-menu">
		  	<div class="logo"> <a href="#" class="sidebar-icon"> <span class="fa fa-bars"></span> </a> <a href="#"> <span id="logo" ></span>
			      <!--<img id="logo" src="" alt="Logo"/>-->
			  </a> </div>
		    <div class="menu">
		      <ul id="menu" >
		       <li id="menu-home" ><a href="/home"><i class="fa fa-home"></i><span>Home</span></a></li>
		         <li><a href="/notifications"><i class="fa fa-bell-o"></i><span>Notifications</span></a></li>

                  <li id="menu-comunicacao" ><a href="/medicines"><i class="fa fa-medkit"></i><span>Medicines</span><span class="fa fa-angle-right" style="float: right;"></span></a>
		          <ul id="menu-comunicacao-sub" >
		            <li id="menu-mensagens" style="width: 120px" ><a href="/medicines">Medicine List</a>
		            </li>
		            <li id="menu-arquivos" ><a href='/medicineListModify'>Add Medicine</a></li>
		          </ul>
		        </li>
                <li><a href="/companies"><i class="fa fa-ambulance"></i><span>Medicine Companies</span><span class="fa fa-angle-right" style="float: right"></span></a>
		          <ul>
		            <li><a href="/companies">Company List</a></li>
		            <li><a href="/addCompany">Register Company</a></li>
		          </ul>
		        </li>

                  <li><a href="/orders"><i class="fa fa-suitcase"></i><span>Orders</span><span class="fa fa-angle-right" style="float: right"></span></a>
		          <ul>
		            <li><a href="/orders">Order List</a></li>
		            <li><a href="/orders/placeOrder">Place Order</a></li>
		          </ul>
		        </li>
		          <li><a href="/makeReceipt"><i class="fa fa-calculator"></i><span>Make Receipt</span></a></li>

		        </li>

		        <li><a href="/finances"><i class="fa fa-dollar"></i><span>Finances</span></a></li>
		        <li><a href="/accounts"><i class="fa fa-list-alt"></i><span>Manage Accounts</span></a></li>
                  <li><a href="/aboutUs"><i class="fa fa-support"></i><span>About Us</span></a>

		        </li>

		      </ul>
		    </div>
	 </div>
	<div class="clearfix"> </div>
</div>
<!--slide bar menu end here-->



<script>
var toggle = true;

$(".sidebar-icon").click(function() {
  if (toggle)
  {
    $(".page-container").addClass("sidebar-collapsed").removeClass("sidebar-collapsed-back");
    $("#menu span").css({"position":"absolute"});
  }
  else
  {
    $(".page-container").removeClass("sidebar-collapsed").addClass("sidebar-collapsed-back");
    setTimeout(function() {
      $("#menu span").css({"position":"relative"});
    }, 400);
  }
                toggle = !toggle;
            });
</script>
<!--scrolling js-->
		<script src="static/js/jquery.nicescroll.js"></script>
		<script src="static/js/scripts.js"></script>
		<!--//scrolling js-->
<script src="static/js/bootstrap.js"> </script>
<!-- mother grid end here-->



</body>
</html>